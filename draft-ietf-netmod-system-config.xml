<?xml version="1.0" encoding="US-ASCII"?>
<!-- This template is for creating an Internet Draft using xml2rfc,
     which is available here: http://xml.resource.org. -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
     There has to be one entity for each item to be referenced.
     An alternate method (rfc include) is described in the references. -->
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC6241 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6241.xml">
<!ENTITY RFC7950 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.7950.xml">
<!ENTITY RFC7149 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.7149.xml">
<!ENTITY RFC7426 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.7426.xml">
<!ENTITY RFC8299 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8299.xml">
<!ENTITY RFC8309 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8309.xml">
<!ENTITY RFC8340 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8340.xml">
<!ENTITY RFC8453 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8453.xml">
<!ENTITY RFC8174 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC8345 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8345.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<!-- used by XSLT processors -->
<!-- For a complete list and description of processing instructions (PIs),
     please see http://xml.resource.org/authoring/README.html. -->
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use.
     (Here they are set differently than their defaults in xml2rfc v1.32) -->
<?rfc strict="yes" ?>
<!-- give errors regarding ID-nits and DTD validation -->
<!-- control the table of contents (ToC) -->
<?rfc toc="yes"?>
<!-- generate a ToC -->
<?rfc tocdepth="4"?>
<!-- the number of levels of subsections in ToC. default: 3 -->
<!-- control references -->
<?rfc symrefs="yes"?>
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] -->
<?rfc sortrefs="yes" ?>
<!-- sort the reference entries alphabetically -->
<!-- control vertical white space
     (using these PIs as follows is recommended by the RFC Editor) -->
<?rfc compact="yes" ?>
<!-- do not start each main section on a new page -->
<?rfc subcompact="no" ?>
<!-- keep one blank line between list items -->
<!-- end of list of popular I-D processing instructions -->
<rfc category="std" docName="draft-ietf-netmod-system-config-latest"
     ipr="trust200902" submissionType="IETF" updates="8342">
  <front>
    <title abbrev="System-defined Configuration">System-defined
    Configuration</title>

    <author fullname="Qiufang Ma" initials="Q." role="editor" surname="Ma">
      <organization>Huawei</organization>

      <address>
        <postal>
          <street>101 Software Avenue, Yuhua District</street>

          <city>Nanjing</city>

          <region>Jiangsu</region>

          <code>210012</code>

          <country>China</country>
        </postal>

        <email>maqiufang1@huawei.com</email>
      </address>
    </author>

    <author fullname="Qin Wu" initials="Q." surname="Wu">
      <organization>Huawei</organization>

      <address>
        <postal>
          <street>101 Software Avenue, Yuhua District</street>

          <city>Nanjing</city>

          <region>Jiangsu</region>

          <code>210012</code>

          <country>China</country>
        </postal>

        <email>bill.wu@huawei.com</email>
      </address>
    </author>

    <author fullname="Chong Feng" initials="C." surname="Feng">
      <organization/>

      <address>
        <email>fengchongllly@gmail.com</email>
      </address>
    </author>

    <date year="2026"/>

    <area>ops</area>

    <workgroup>NETMOD</workgroup>

    <keyword>system config</keyword>

    <abstract>
      <t>The Network Management Datastore Architecture (NMDA) in RFC 8342
      defines several configuration datastores holding configuration. The
      contents of these configuration datastores are controlled by clients.
      This document introduces the concept of system configuration datastore
      holding configuration controlled by the system on which a server is
      running. The system configuration can be referenced (e.g., leafref) by
      configuration explicitly created by clients.</t>

      <t>This document updates RFC 8342.</t>
    </abstract>
  </front>

  <middle>
    <section anchor="Introduction" title="Introduction">
      <t>The Network Management Datastore Architecture (NMDA) <xref
      target="RFC8342"/> defines system configuration as the configuration
      that is supplied by the device itself and appears in &lt;operational&gt;
      when it is in use (Figure 2 in <xref target="RFC8342"/>).</t>

      <t>However, there is a desire from operators to enable a server to
      better expose the system configuration, regardless of whether it is in
      use. For example, some implementations define the system configuration
      which must be referenced to be active. NETCONF/RESTCONF clients can
      benefit from a standard mechanism to retrieve what system configuration
      is available on a server.</t>

      <t>Some servers allow the descendant nodes of system-defined
      configuration to be configured or modified. For example, the system
      configuration may contain an almost empty physical interface, whose
      existence in the system configuration is tied to the presence of
      particular hardware, while the client needs to be able to add, modify,
      or remove a number of descendant nodes. Some descendant nodes may not be
      modifiable (e.g., the interface "type" set by the system).</t>

      <t>This document updates the NMDA defined in <xref target="RFC8342"/>
      with a read-only conventional configuration datastore called "system" to
      expose system-defined configuration. The solution enables configuration
      explicitly created by the clients to reference nodes defined in
      &lt;system&gt;, override system-provided values, and configure
      descendant nodes of system-defined configuration.</t>

      <t>The solution defined in this document requires the use of NMDA for
      both clients and servers. Conformance to this document requires NMDA
      servers implement the "ietf-system-datastore" YANG module (<xref
      target="system-datastore"/>).</t>

      <section anchor="terminology" title="Terminology">
        <t>This document assumes that the reader is familiar with the contents
        of <xref target="RFC6241"/>, <xref target="RFC7950"/>, <xref
        target="RFC8342"/>, and <xref target="RFC8525"/> and uses
        terminologies from those documents. The terms "device" and "server"
        are used interchangeably in this document.</t>

        <t>The following terms are defined in this document:<list
            style="hanging">
            <t hangText="system configuration: "><xref format="none"
            target="RFC8342">RFC 8342</xref> defines it as "Configuration that
            is supplied by the device itself." The definition herein refines
            that definition of system configuration to represent configuration
            present in the system configuration datastore (regardless of
            whether it is applied or referenced). It may also be referred to
            as "system-defined configuration" or "system-provided
            configuration" throughout this document. The system configuration
            discussed in this document cannot be deletable; configuration
            provided by the server that is deletable is outside the scope of
            this document.</t>

            <t hangText="system configuration datastore: ">A configuration
            datastore holding configuration provided by the system itself.
            This datastore is referred to as "&lt;system&gt;".</t>
          </list>This document redefines the term "conventional configuration
        datastore" in <xref section="3" sectionFormat="of" target="RFC8342"/>
        to add "system" to the list of conventional configuration
        datastores:<list style="hanging">
            <t hangText="conventional configuration datastore: ">One of the
            following set of configuration datastores: &lt;running&gt;,
            &lt;startup&gt;, &lt;candidate&gt;, &lt;system&gt;, and
            &lt;intended&gt;. These datastores share a common datastore
            schema, and protocol operations allow copying data between these
            datastores. The term "conventional" is chosen as a generic
            umbrella term for these datastores. Note while protocol operations
            allow copying data between conventional datastores, the read-only
            nature of datastores such as &lt;system&gt; and &lt;intended&gt;
            restricts clients from copying data into them.</t>

            <t hangText="system node: ">An instance in the data tree that is
            provided by the system itself. System node may also be called
            "system-defined node" or "system-provided node" throughout this
            document.</t>

            <t hangText="referenced node: ">A referenced node is one of:<list
                style="symbols">
                <t>Targets of leafref values defined via the "path"
                statement.</t>

                <t>Targets of "instance-identifier" type values.</t>

                <t>Nodes present in an XPath expression of "when"
                constraints.</t>

                <t>Nodes present in an XPath expression of "must"
                constraints.</t>

                <t>Nodes defined to satisfy the "mandatory true"
                constraints.</t>

                <t>Nodes defined to satisfy the "min-elements"
                constraints.</t>
              </list></t>
          </list></t>
      </section>

      <section title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described in BCP
        14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only
        when, they appear in all capitals, as shown here.</t>
      </section>

      <section title="Updates to RFC 8342">
        <t>This document updates <xref target="RFC8342"/> to define a configuration datastore
        called "system" that holds system configuration (<xref
        target="system-ds-def"/>). The document also redefines the term "conventional
        configuration datastore" from <xref format="none"
        target="RFC8342">RFC8342</xref> to include "system" in the list.</t>

        <t>To ensure the validity of &lt;intended&gt; when clients interact
        with system configuration (e.g., configuration provided by clients
        references system configuration) and allow the existence of
        system-defined templates and inactive system configuration,
        configuration in &lt;running&gt; is merged with &lt;system&gt; to
        create the contents of &lt;intended&gt; after the configuration
        transformations (e.g., template expansion, removal of inactive
        configuration defined in <xref target="RFC8342"/>) have been
        performed, as described in <xref target="conceptual-model"/>.
        Specifications in <xref target="RFC8342"/> related to the processing
        of system configuration are updated by the mechanism defined in this
        document.</t>

        <t>Additionally, this document also updates the definition of
        "intended" origin metadata annotation identity defined in <xref
        section="5.3.4" sectionFormat="of" target="RFC8342"/>. The "intended"
        identity of origin value defined in <xref target="RFC8342"/> represents the origin of configuration
        provided by &lt;intended&gt. This document updates that definition as
        the origin source of configuration explicitly provided by clients, and
        allows a subset of configuration in &lt;intended&gt; that flows from
        &lt;system&gt; yet is not configured or overridden explicitly in
        &lt;running&gt; to use "system" as its origin value. As per <xref
        section="5.3.4" sectionFormat="of" target="RFC8342"/>, all
        configuration with origin value being reported as "intended" MUST
        originate from &lt;running&gt;, which includes any configuration in
        &lt;system&gt; that has been copied into &lt;running&gt;.
        Configuration that is in &lt;system&gt; and not also present in
        &lt;running&gt; MUST be reported as origin "system" in
        &lt;operational&gt;.</t>
      </section>
    </section>

    <section anchor="categories" title="Kinds of System Configuration">
      <t>This document defines two types of system configuration.
      Configuration that is always-present and configuration that is
      conditionally-present. These types of system configuration are described
      in <xref target="immediate"/> and <xref target="conditional"/>,
      respectively.</t>

      <section anchor="immediate" title="Always-Present">
        <t>Always-present refers to system configuration which is generated in
        &lt;system&gt; when the device is powered on, irrespective of whether
        physical resources are present or whether a special functionality is
        enabled. An example of always-present system configuration is an
        always-existing loopback interface.</t>
      </section>

      <section anchor="conditional" title="Conditionally-Present">
        <t>Conditionally-present refers to system configuration which is
        generated in &lt;system&gt; based on specific conditions being met in
        a system. For example, if a physical resource is present (e.g., an
        interface card is inserted), the system automatically detects it and
        loads the associated configuration; when the physical resource is not
        present (an interface card is removed), the system configuration will
        automatically be removed from &lt;system&gt;. Another example is when
        a special functionality (e.g., a license or feature) is enabled,
        specific configuration may be created by the system.</t>
      </section>
    </section>

    <section anchor="system-ds-def"
             title="The System Configuration Datastore (&lt;system&gt;)">
      <t>Following guidelines for defining datastores in the <xref section="A"
      sectionFormat="of" target="RFC8342"/>, this document introduces a new
      datastore resource named "system" that represents the system
      configuration. NMDA servers compliant with this document MUST implement
      a system configuration datastore, and they SHOULD also implement
      &lt;intended&gt;.</t>

      <t><list style="symbols">
          <t>Name: "system".</t>

          <t>YANG modules: all.</t>

          <t>YANG nodes: all "config true" data nodes up to the root node,
          generated by the system.</t>

          <t>Management operations: The datastore can be read using network
          management protocols such as NETCONF and RESTCONF, but its contents
          cannot be changed by management operations via NETCONF and RESTCONF
          protocols.</t>

          <t>Origin: This document does not define any new origin identity.
          The "system" identity of origin metadata annotation <xref
          target="RFC7952"/> is used to indicate the origin of a data item
          provided in &lt;system&gt;.</t>

          <t>Protocols: YANG-driven management protocols, such as NETCONF and
          RESTCONF.</t>

          <t>Defining YANG module: "ietf-system-datastore" (<xref
          target="system-datastore"/>).</t>
        </list></t>

      <t>The system configuration datastore does not persist across
      reboots.</t>
    </section>

    <section anchor="conceptual-model" title="Conceptual Model of Datastores">
      <t>Clients may provide configuration nodes that reference nodes defined
      in &lt;system&gt;, override system-provided values, and configure
      descendant nodes of system-defined configuration in &lt;running&gt;, as
      detailed in <xref target="dynamic"/>.</t>

      <t>To ensure the validity of &lt;intended&gt;, configuration in
      &lt;running&gt; is merged with &lt;system&gt; to become
      &lt;intended&gt;, in which process, configuration appearing in
      &lt;running&gt; takes precedence over the same node in &lt;system&gt;.
      Since it is unspecified how to merge configuration before
      transformations, if &lt;system&gt; or &lt;running&gt; includes
      configuration that requires further transformation (e.g., template
      expansion, removal of inactive configuration defined in <xref
      target="RFC8342"/>) before it can be applied, configuration
      transformations MUST be performed independently on each datastore before
      &lt;running&gt; is merged with &lt;system&gt;.</t>

      <t>Whenever configuration in &lt;system&gt; changes, the server MUST
      also immediately update and validate &lt;intended&gt;.</t>

      <t>As a result, Figure 2 in <xref section="5" sectionFormat="of"
      target="RFC8342"/> is updated with the below conceptual model of
      datastores which incorporates the system configuration datastore.<figure
          align="center" title="Architectural Model of Datastores">
          <artwork>               +-------------+                 +-----------+
               | &lt;candidate&gt; |                 | &lt;startup&gt; |
               |  (ct, rw)   |&lt;---+      +----&gt;| (ct, rw)  |
               +-------------+    |      |     +-----------+
                      |           |      |           |
+-----------+         |        +-----------+         |
| &lt;system&gt;  |         +-------&gt;| &lt;running&gt; |&lt;--------+
| (ct, ro)  |                  | (ct, rw)  |
+-----------+                  +-----------+
     |                              |
     |                              |
     |                              | // configuration transformations,
     +--------------+---------------+ // e.g., removal of nodes marked
                    |                 // as "inactive", expansion of
                    |                 // templates
                    v
              +------------+
              | &lt;intended&gt; |  // subject to validation
              | (ct, ro)   |
              +------------+
                     |       // changes applied, subject to
                     |       // local factors, e.g., missing
                     |       // resources, delays
 dynamic             |
 configuration       |   +-------- learned configuration
 datastores -----+   |   +-------- default configuration
                 |   |   |
                 v   v   v
             +---------------+
             | &lt;operational&gt; | &lt;-- system state
             | (ct + cf, ro) |
             +---------------+

ct = config true; cf = config false
rw = read-write; ro = read-only
boxes denote named datastores</artwork>
        </figure></t>

      <t>Configuration in &lt;system&gt; cannot be deleted by clients (e.g., a
      list entry can never be removed from &lt;system&gt; through protocol
      operations), even though a node defined in &lt;system&gt; may be
      overridden in &lt;running&gt;. If the system initializes a value for a
      particular leaf which is overridden by the client with a different value
      in &lt;running&gt; (<xref target="modifying"/>), and if the node in
      &lt;running&gt; is removed at a later time, the system-initialized value
      defined in &lt;system&gt; appears in &lt;intended&gt; and may come into
      use eventually if applied successfully.</t>

      <t>Configuration may disappear from &lt;system&gt; due to, e.g.,
      resources no longer available. In such cases, configuration for missing
      resources can still remain in &lt;running&gt; and &lt;intended&gt;, but
      it will not be applied and appear in &lt;operational&gt;. This is
      further clarified in <xref section="5.3.2" sectionFormat="of"
      target="RFC8342"/>.</t>
    </section>

    <section title="Static Characteristics">
      <section title="Read-only to Clients">
        <t>The system datastore is read-only (i.e., edits towards
        &lt;system&gt; directly MUST be denied), though the client may be
        allowed to provide configuration that overrides the value of a
        system-initialized node (see <xref target="modifying"/>).</t>
      </section>

      <section title="No Changes to &lt;operational&gt;">
        <t>This work does not change the definition of &lt;operational&gt;,
        nor does it impact the contents of &lt;operational&gt;, as specified
        in <xref target="RFC8342"/>. It clarifies origin reporting, i.e., the
        origin of nodes sourced from &lt;system&gt; is reported as "system"
        unless explicitly configured or overridden in &lt;running&gt;.
        &lt;system&gt; enables system-defined nodes to be defined like
        configuration, i.e., made visible to clients in order for being
        referenced or configurable prior to present in &lt;operational&gt;.
        "config false" nodes are out of scope, hence existing "config false"
        nodes are not impacted by this work.</t>
      </section>
    </section>

    <section anchor="dynamic" title="Dynamic Behaviors">
      <section title="May Change via Software Upgrades or Resource Changes">
        <t>The contents of &lt;system&gt; MAY change dynamically under various
        conditions, such as license change, software upgrade, and
        system-controlled resources change (see <xref target="conditional"/>).
        The updates of system configuration may be obtained through YANG
        notifications (e.g., on-change notification) <xref
        target="RFC8639"/><xref target="RFC8641"/>.</t>

        <t>If system configuration changes (e.g., during a software upgrade),
        &lt;running&gt; SHOULD remain a valid configuration data tree. Any
        mechanisms to achieve this are outside the scope of this document.</t>
      </section>

      <section anchor="declare" title="Referencing System Configuration">
        <t>Clients may create configuration data in &lt;running&gt; that
        references nodes in &lt;system&gt;. Some implementations may define
        system nodes solely as a convenience for clients to reference. It is
        also possible for the clients to define their customized nodes for
        reference.</t>

        <t><xref target="declare-example"/> provides an example of a client
        referencing system-defined nodes.</t>
      </section>

      <section anchor="modifying"
               title="Modifying (Overriding) System Configuration">
        <t>Although &lt;system&gt; is read-only, in some cases, a server may
        allow some parts of system configuration (e.g., a leaf's value) to be
        modified (note the distinction between &lt;system&gt; and system
        configuration). Modification of system configuration is achieved by
        the client writing configuration data in &lt;running&gt; that
        overrides the values of matched configuration nodes at the
        corresponding level in &lt;system&gt;. Configurations defined in
        &lt;running&gt; take precedence over system configuration nodes in
        &lt;system&gt; if the server allows the nodes to be modified (some
        implementations may have immutable system configuration which is
        identified by the server using an immutable metadata annotation, see
        <xref target="I-D.ietf-netmod-immutable-flag"/> for details),
        regardless of whether a system-instantiated value changes
        subsequently.</t>

        <t><xref target="modify-example"/> provides an example of a client
        overriding a system-instantiated leaf's value.</t>
      </section>

      <section title="Configuring Descendant nodes of System Configuration">
        <t>A server may also allow a client to add nodes to a list entry in
        &lt;system&gt; by writing those additional nodes in &lt;running&gt;.
        Those additional data nodes may not exist in &lt;system&gt; (i.e., an
        addition rather than an override).</t>

        <t><xref target="configure-example"/> provides an example of a client
        configuring descendant nodes of a system-defined node.</t>
      </section>
    </section>

    <section anchor="system-datastore"
             title="The &quot;ietf-system-datastore&quot; Module">
      <section title="Data Model Overview">
        <t>This YANG module defines a new YANG identity named "system" that
        uses the "ds:conventional" identity defined in <xref
        target="RFC8342"/> as its base. A client can discover the system
        configuration datastore support on the server by reading the YANG
        library information from the operational state datastore.</t>

        <t>The system datastore is defined as a conventional configuration
        datastore and shares a common datastore schema with other conventional
        datastores.</t>

        <t>The following diagram illustrates the relationship amongst the
        "identity" statements defined in the "ietf-system-datastore" and
        "ietf-datastores" YANG modules: <figure>
            <artwork>Identities:
    +--- datastore
    |  +--- conventional
    |  |  +--- running
    |  |  +--- candidate
    |  |  +--- startup
    |  |  +--- system
    |  |  +--- intended
    |  +--- dynamic
    |  +--- operational</artwork>
          </figure>The diagram above uses syntax that is similar to but not
        defined in <xref target="RFC8340"/>.</t>
      </section>

      <section title="YANG Module">
        <figure>
          <preamble>&lt;CODE BEGINS&gt; file
          "ietf-system-datastore@YYYY-MM-DD.yang"</preamble>

              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(yang/ietf-system-datastore@YYYY-MM-DD.yang)
]]></artwork>

          <postamble>&lt;CODE ENDS&gt;</postamble>
        </figure>
      </section>

      <section title="Example Usage">
        <t>The following example shows how the configuration in &lt;system&gt;
        could be retrieved in a NETCONF &lt;get-data&gt; RPC operation. The
        example uses the "example-application" fictional data model defined in
        <xref target="declare-example"/>.</t>

        <figure>
          <artwork>   &lt;rpc message-id="101"
        xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;  
     &lt;get-data xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-nmda"
        xmlns:sysds="urn:ietf:params:xml:ns:yang:ietf-system-datastore"&gt;  
       &lt;datastore&gt;sysds:system&lt;/datastore&gt;  
       &lt;subtree-filter&gt; 
         &lt;applications xmlns="urn:example:application"/&gt; 
       &lt;/subtree-filter&gt; 
     &lt;/get-data&gt; 
   &lt;/rpc&gt;</artwork>
        </figure>

        <t>When using the RESTCONF protocol, the system configuration
        datastore can be accessed via the resource:
        {+restconf}/ds/ietf-system-datastore:system. The following example
        uses an HTTP GET method to request "applications" configuration:</t>

        <figure>
          <artwork>GET /restconf/ds/ietf-system-datastore:system/\
   example-application:applications HTTP/1.1
Host: example.com
Accept: application/yang-data+xml</artwork>
        </figure>
      </section>
    </section>

    <section anchor="IANA" title="IANA Considerations">
      <section title="The &quot;IETF XML&quot; Registry">
        <t>IANA is requested to register the following XML namespace URI in
        the 'IETF XML registry', following the format defined in <xref
        target="RFC3688"/>.</t>

        <figure>
          <artwork>   URI: urn:ietf:params:xml:ns:yang:ietf-system-datastore
   Registrant Contact: The IESG.
   XML: N/A, the requested URIs are XML namespaces.</artwork>
        </figure>
      </section>

      <section title="The &quot;YANG Module Names&quot; Registry">
        <t>IANA is requested to register the following YANG module in the
        'YANG Module Names' registry, defined in <xref target="RFC6020"/>.</t>

        <figure>
          <artwork>      name: ietf-system-datastore
      prefix: sysds
      namespace: urn:ietf:params:xml:ns:yang:ietf-system-datastore
      maintained by IANA? N
      RFC: XXXX // RFC Ed.: replace XXXX and remove this comment</artwork>
        </figure>
      </section>
    </section>

    <section title="Operational Considerations">
      <t>System configuration exists regardless of whether the server
      implements &lt;system&gt; or not. The introduction of &lt;system&gt;
      provides a standardized way to expose system configuration within
      NMDA.</t>

      <t>NMDA clients that are not aware of &lt;system&gt; will continue to
      operate correctly. They will interact only with datastores such as
      &lt;running&gt;, &lt;candidate&gt;, &lt;intended&gt;, and
      &lt;operational&gt; as before. The presence of &lt;system&gt; does not
      change the fundamental behavior for such legacy clients. Operators
      should be aware that to fully leverage the capabilities defined in this
      document, client applications need to be updated to recognize and
      interact with &lt;system&gt;.</t>
    </section>

    <section anchor="scecurity" title="Security Considerations">
      <section title="Considerations for the &quot;ietf-system-datastore&quot; YANG Module">
        <t>This section is modeled after the template described in <xref
        section="3.7" sectionFormat="of"
        target="I-D.ietf-netmod-rfc8407bis"/>.</t>

        <t>The "ietf-system-datastore" YANG module defines a data model that
        is designed to be accessed via YANG-based management protocols, such
        as NETCONF <xref target="RFC6241"/> and RESTCONF <xref
        target="RFC8040"/>. These protocols have to use a secure transport
        layer (e.g., SSH <xref target="RFC4252"/>, TLS <xref
        target="I-D.ietf-tls-rfc8446bis"/>, and QUIC <xref target="RFC9000"/>)
        and have to use mutual authentication.</t>

        <t>The Network Configuration Access Control Model (NACM) <xref
        target="RFC8341"/> provides the means to restrict access for
        particular NETCONF or RESTCONF users to a preconfigured subset of all
        available NETCONF or RESTCONF protocol operations and content.</t>

        <t>The YANG module only defines an identity that uses the
        "ds:conventional" identity as its base. The module by itself does not
        expose any data nodes that are writable, data nodes that contain
        read-only state, or RPCs. As such, there are no additional security
        issues related to the YANG module that need to be considered.</t>
      </section>

      <section title="Considerations for System Configuration">
        <t>The system datastore, while read-only to clients, may contain
        sensitive information such as hardware identifiers, security policies,
        and critical system resources. Read access to sensitive system nodes
        and subtrees within the datastore MUST be controlled to prevent
        unauthorized disclosure. Implementations are strongly advised to log
        all access attempts to sensitive system configuration for audit
        purposes.</t>

        <t>Furthermore, while &lt;system&gt; cannot be modified directly,
        system configuration may be overridden as a merging result (<xref
        target="modifying"/>). An attacker may configure a leaf that shadows a
        sensitive node in &lt;system&gt;. Misconfiguration in &lt;running&gt;
        could lead to unintended system behavior including security policy
        bypass and availability risks. Unauthorized modification to sensitive
        contents MUST be prevented to avoid those negative effects on the
        network.</t>
      </section>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc include="reference.RFC.2119.xml"?>

      <?rfc include="reference.RFC.7950.xml"?>

      <?rfc include="reference.RFC.7952.xml"?>

      <?rfc include="reference.RFC.8341.xml"?>

      <?rfc include="reference.RFC.8342.xml"?>
    </references>

    <references title="Informative References">
      <?rfc include="reference.RFC.3688.xml"?>

      <?rfc include="reference.RFC.4252.xml"?>

      <?rfc include="reference.RFC.6020.xml"?>

      <?rfc include="reference.RFC.6241.xml"?>

      <?rfc include="reference.RFC.8040.xml"?>

      <?rfc include="reference.RFC.8174.xml"?>

      <?rfc include="reference.RFC.8340.xml"?>

      <?rfc include="reference.RFC.8525.xml"?>

      <?rfc include="reference.RFC.8639.xml"?>

      <?rfc include="reference.RFC.8641.xml"?>

      <?rfc include="reference.RFC.9000.xml"?>

      <xi:include href="https://datatracker.ietf.org/doc/bibxml3/reference.I-D.ietf-tls-rfc8446bis.xml"
                  xmlns:xi="http://www.w3.org/2001/XInclude"/>

      <xi:include href="https://datatracker.ietf.org/doc/bibxml3/reference.I-D.ietf-netmod-immutable-flag.xml"
                  xmlns:xi="http://www.w3.org/2001/XInclude"/>

      <xi:include href="https://datatracker.ietf.org/doc/bibxml3/reference.I-D.ietf-netmod-rfc8407bis.xml"
                  xmlns:xi="http://www.w3.org/2001/XInclude"/>
    </references>

    <section title="Example of Dynamic Behaviors">
      <t>This section presents some sample data models and corresponding
      contents of various datastores with different dynamic behaviors
      described in <xref target="dynamic"/>. The XML snippets are used only
      for illustration purposes. Note this section does not show the contents
      of &lt;intended&gt; as they are related to the configuration in
      &lt;operational&gt; assuming the intended configuration is applied
      successfully. Also note that if the "origin" metadata annotation for
      configuration is unspecified in snippets, it is inherited from its
      parent node.</t>

      <t/>

      <section anchor="declare-example"
               title="Referencing System-defined Nodes">
        <t>In this subsection, the following fictional module is used:<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/example-application.yang)
              ]]></artwork>
          </figure>A fictional ACL YANG module is used as follows, which
        defines a leafref for the leaf-list "application" data node to refer
        to an existing application name.<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/example-acl.yang)
              ]]></artwork>
          </figure></t>

        <t>The server may predefine some applications as a convenience for
        clients, these applications are immediately-present system
        configuration. When the device is powered on, the system-instantiated
        application entries may be present in &lt;system&gt; as follows:</t>

        <figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/applications-system.xml)
              ]]></artwork>
        </figure>

        <t>The client may also define customized applications. Those
        applications may be present in &lt;running&gt; as follows:<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/applications-running.xml)
              ]]></artwork>
          </figure></t>

        <t>If a client configures an ACL rule referencing some system-provided
        or customized applications, the configuration of ACL rule may be shown
        as follows:<figure>
             <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/applications-referenced.xml)
               ]]></artwork>
          </figure></t>

        <t>As different entries of application configuration in &lt;system&gt;
        and &lt;running&gt; are merged to create &lt;intended&gt;, and there
        are no merging conflicts in the contents between &lt;system&gt; and
        &lt;running&gt;, &lt;operational&gt; might contain the configuration
        of applications with the values of origin reflecting the source of
        entries as follows:<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/applications-declare-operational.xml)
              ]]></artwork>
          </figure></t>
      </section>

      <section anchor="modify-example"
               title="Modifying a System-instantiated Leaf's Value">
        <t>This subsection uses the following fictional interface YANG
        module:<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/example-interface.yang)
              ]]></artwork>
          </figure></t>

        <t>Suppose the system provides an always-present loopback interface
        (named "lo0") with an MTU value "65536", a default IPv4 address of
        "127.0.0.1", and a default IPv6 address of "::1". The configuration of
        "lo0" interface may be present in &lt;system&gt; as follows:<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/interface-system.xml)
              ]]></artwork>
          </figure></t>

        <t>A client modifies the value of MTU to 9216 by adding the following
        configuration into &lt;running&gt;:</t>

        <figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/interface-running-overridden.xml)
              ]]></artwork>
        </figure>

        <t>Since the MTU value provided by the client takes precedence over
        the system-provided value, and the "origin" value of configuration
        provided by the client is set to "intended", the configuration of
        interfaces that is present in &lt;operational&gt; may be as
        follows:<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/interface-operational-overridden.xml)
              ]]></artwork>
          </figure></t>
      </section>

      <section anchor="configure-example"
               title="Configuring Descendant Nodes of a System-defined Node">
        <t>Based on the example in <xref target="modify-example"/>, imagine
        the client further adds the description node of a "lo0" interface in
        &lt;running&gt; as follows:</t>

        <figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/interface-running-addition.xml)
              ]]></artwork>
        </figure>

        <t>The configuration of interface "lo0" is present in
        &lt;operational&gt; as follows:<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/interface-operational-addition.xml)
              ]]></artwork>
          </figure></t>
      </section>
    </section>

    <section title="Key Use Cases">
      <t>This section updates the "Interface Example" supplied in <xref
      section="C.3" sectionFormat="of" target="RFC8342"/>.</t>

      <t>This section provides several use cases related to how &lt;system&gt;
      interacts with other datastores (e.g., &lt;candidate&gt;,
      &lt;running&gt;, &lt;intended&gt;, and &lt;operational&gt;). The
      following fictional interface data model is used:<figure>
              <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(examples/example-interface-management.yang)          
                           ]]></artwork>
        </figure>For each use case, corresponding sample configuration in
      &lt;running&gt;, &lt;system&gt;, &lt;intended&gt; and
      &lt;operational&gt; are shown. The XML snippets are used only for
      illustration purposes.</t>

      <section title="Device Powers On">
        <t>When the device is powered on, suppose the system provides an
        always-present loopback interface (named "lo0") which is not
        explicitly configured in &lt;running&gt;. Thus, no configuration for
        interfaces appears in &lt;running&gt;;</t>

        <t>And the contents of &lt;system&gt; are:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt;  
  &lt;interface&gt; 
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt;  
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt;  
    &lt;description&gt;system-defined interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;</artwork>
        </figure>

        <t>In this case, the configuration of loopback interface is only
        present in &lt;system&gt;, the configuration of interface in
        &lt;intended&gt; would be identical to the one in &lt;system&gt; shown
        above.</t>

        <t>And &lt;operational&gt; will show the system-provided loopback
        interface, note that &lt;operational&gt; also includes the default
        value specified in the YANG module:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"
            xmlns:or="urn:ietf:params:xml:ns:yang:ietf-origin"
            or:origin="or:system"&gt;
  &lt;interface&gt; 
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt;  
    &lt;enabled or:origin="or:default"&gt;true&lt;/enabled&gt;  
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt;  
    &lt;description&gt;system-defined interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;</artwork>
        </figure>
      </section>

      <section title="Client Commits Configuration">
        <t>If a client creates an interface "et-0/0/0" but the interface does
        not physically exist at this point, what is in &lt;running&gt; appears
        as follows:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;ip-address&gt;192.168.10.10&lt;/ip-address&gt;
    &lt;description&gt;pre-provisioned interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;</artwork>
        </figure>

        <t>And the contents of &lt;system&gt; remain unchanged, only
        containing the "lo0" loopback interface, since the interface
        "et-0/0/0" is not physically present:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
&lt;/interfaces&gt;</artwork>
        </figure>

        <t>The contents of &lt;intended&gt; represent the merged data of
        &lt;system&gt; and &lt;running&gt;:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;  
    &lt;ip-address&gt;192.168.10.10&lt;/ip-address&gt;
    &lt;description&gt;pre-provisioned interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;</artwork>
        </figure>

        <t>Since the interface named "et-0/0/0" does not exist, the associated
        configuration is not present in &lt;operational&gt;, which appears as
        follows:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"
            xmlns:or="urn:ietf:params:xml:ns:yang:ietf-origin"
            or:origin="or:intended"&gt;
  &lt;interface or:origin="or:system"&gt;
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;enabled or:origin="or:default"&gt;true&lt;/enabled&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
&lt;/interfaces&gt;              </artwork>
        </figure>
      </section>

      <section title="Operator Installs Card into a Chassis">
        <t>When the interface is installed by the operator, the system will
        detect it and generate the associated conditionally-present interface
        configuration in &lt;system&gt;. The contents of &lt;running&gt; keep
        unchanged:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;ip-address&gt;192.168.10.10&lt;/ip-address&gt;
    &lt;description&gt;pre-provisioned interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;</artwork>
        </figure>

        <t>And &lt;system&gt; might appear as follows:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;type&gt;ethernet&lt;/type&gt;
    &lt;description&gt;system-defined interface&lt;/description&gt;
  &lt;/interface&gt; 
&lt;/interfaces&gt;</artwork>
        </figure>

        <t>Then &lt;intended&gt; contains the merged configuration of
        &lt;system&gt; and &lt;running&gt;:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;type&gt;ethernet&lt;/type&gt;
    &lt;ip-address&gt;192.168.10.10&lt;/ip-address&gt;
    &lt;description&gt;pre-provisioned interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;</artwork>
        </figure>

        <t>And the contents of &lt;operational&gt; appear as follows:</t>

        <figure>
          <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"
            xmlns:or="urn:ietf:params:xml:ns:yang:ietf-origin"
            or:origin="or:intended"&gt;
  &lt;interface or:origin="or:system"&gt;
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;enabled or:origin="or:default"&gt;true&lt;/enabled&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;type or:origin="or:system"&gt;ethernet&lt;/type&gt;
    &lt;enabled or:origin="or:default"&gt;true&lt;/enabled&gt;  
    &lt;ip-address&gt;192.168.10.10&lt;/ip-address&gt;
    &lt;description&gt;pre-provisioned interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;            </artwork>
        </figure>
      </section>

      <section title="Client further Commits Configuration">
        <t>If the client further sets the speed of interface "et-0/0/0" in
        &lt;running&gt;:<figure>
            <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;speed&gt;10Mb&lt;/speed&gt;
  &lt;/interface&gt; 
&lt;/interfaces&gt;           </artwork>
          </figure></t>

        <t>The contents of &lt;system&gt; keep unchanged:<figure>
            <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;type&gt;ethernet&lt;/type&gt;
    &lt;description&gt;system-defined interface&lt;/description&gt;
  &lt;/interface&gt; 
&lt;/interfaces&gt;         </artwork>
          </figure></t>

        <t>And the contents of &lt;intended&gt; which represents a merged
        results of &lt;running&gt; and &lt;system&gt; are as follows:<figure>
            <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"&gt; 
  &lt;interface&gt; 
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;type&gt;ethernet&lt;/type&gt;
    &lt;ip-address&gt;192.168.10.10&lt;/ip-address&gt;
    &lt;speed&gt;10Mb&lt;/speed&gt;
    &lt;description&gt;pre-provisioned interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;           </artwork>
          </figure></t>

        <t>And &lt;operational&gt; would appear as follows:<figure>
            <artwork>&lt;interfaces xmlns="urn:example:interfacemgmt"
            xmlns:or="urn:ietf:params:xml:ns:yang:ietf-origin"
            or:origin="or:intended"&gt;
  &lt;interface or:origin="or:system"&gt;
    &lt;name&gt;lo0&lt;/name&gt;  
    &lt;type&gt;loopback&lt;/type&gt; 
    &lt;enabled&gt;true&lt;/enabled&gt; 
    &lt;ip-address&gt;127.0.0.1&lt;/ip-address&gt;  
    &lt;ip-address&gt;::1&lt;/ip-address&gt; 
    &lt;description&gt;system-defined interface&lt;/description&gt;  
  &lt;/interface&gt; 
  &lt;interface&gt; 
    &lt;name&gt;et-0/0/0&lt;/name&gt;
    &lt;type or:origin="or:system"&gt;ethernet&lt;/type&gt; 
    &lt;enabled or:origin="or:default"&gt;true&lt;/enabled&gt;
    &lt;ip-address&gt;192.168.10.10&lt;/ip-address&gt;
    &lt;speed&gt;10Mb&lt;/speed&gt; 
    &lt;description&gt;pre-provisioned interface&lt;/description&gt; 
  &lt;/interface&gt; 
&lt;/interfaces&gt;            </artwork>
          </figure></t>
      </section>
    </section>

    <section anchor="Acknowledgements" numbered="no" title="Acknowledgements">
      <t>The authors would like to thank for following for discussions and
      providing input to this document: Balazs Lengyel, Robert Wilton, Juergen
      Schoenwaelder, Andy Bierman, Martin Bjorklund, Mohamed Boucadair, Michal
      Va&scaron;ko, Alexander Clemm, and Timothy Carey.</t>
    </section>

    <section numbered="no" title="Contributors">
      <figure>
        <artwork>      
Kent Watsen
Watsen Networks
Email: kent+ietf@watsen.net

Jan Lindblad
Cisco Systems
Email: jlindbla@cisco.com

Jason Sterne
Nokia
Email: jason.sterne@nokia.com

Chongfeng Xie
China Telecom
Beijing
China
Email: xiechf@chinatelecom.cn
</artwork>
      </figure>
    </section>
  </back>
</rfc>
